{"ast":null,"code":"import _taggedTemplateLiteral from\"C:\\\\Users\\\\osama\\\\Desktop\\\\New folder\\\\cldc-project\\\\server\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";import _toConsumableArray from\"C:\\\\Users\\\\osama\\\\Desktop\\\\New folder\\\\cldc-project\\\\server\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"C:\\\\Users\\\\osama\\\\Desktop\\\\New folder\\\\cldc-project\\\\server\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:\\\\Users\\\\osama\\\\Desktop\\\\New folder\\\\cldc-project\\\\server\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\osama\\\\Desktop\\\\New folder\\\\cldc-project\\\\server\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  font-size: calc(20px + 5vmin);\\n  z-index: 1;\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  justify-content: center;\\n  align-items: center;  \\n  position: relative;\\n  display: flex;\\n  \\n  > video {\\n    top: 0;\\n    left: 0;\\n    width: 100%;\\n    height: 100%;\\n  }\\n\\n  :hover {\\n    > i {\\n      display: block;\\n    }\\n  }\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  max-width: 100%;\\n  height: 86%;\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-around;\\n  flex-wrap: wrap;\\n  align-items: center;\\n  padding: 15px;\\n  box-sizing: border-box;\\n  gap: 10px;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  position: relative;\\n  width: 100%;\\n  height: 100vh;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  width: 100%;\\n  max-height: 100vh;\\n  flex-direction: row;\\n  background-color: #f0f0f0;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  display: none;\\n  position: absolute;\\n  right: 15px;\\n  top: 15px;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}//imports\nimport React,{useState,useEffect,useRef}from'react';import Peer from'simple-peer';import styled from'styled-components';import socket from'../../socket';import UpperBar from'../UpperBar/UpperBar';import VideoCard from'../Video/VideoCard';import BottomBar from'../BottomBar/BottomBar';import Chat from'../Chat/Chat';//--------------------------------------------------------------------------------\nvar MeetRoom=function MeetRoom(props){var currentUser=sessionStorage.getItem('user');var _useState=useState([]),_useState2=_slicedToArray(_useState,2),peers=_useState2[0],setPeers=_useState2[1];var _useState3=useState({localUser:{video:true,audio:true}}),_useState4=_slicedToArray(_useState3,2),userVideoAudio=_useState4[0],setUserVideoAudio=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),videoDevices=_useState6[0],setVideoDevices=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),displayChat=_useState8[0],setDisplayChat=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),screenShare=_useState10[0],setScreenShare=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showVideoDevices=_useState12[0],setShowVideoDevices=_useState12[1];var peersRef=useRef([]);var userVideoRef=useRef();var screenTrackRef=useRef();var userStream=useRef();var roomId=props.match.params.roomId;useEffect(function(){navigator.mediaDevices.enumerateDevices().then(function(devices){var filtered=devices.filter(function(device){return device.kind==='videoinput';});setVideoDevices(filtered);});window.addEventListener('popstate',goToBack);navigator.mediaDevices.getUserMedia({video:true,audio:true}).then(function(stream){userVideoRef.current.srcObject=stream;userStream.current=stream;// user joins room\nsocket.emit('room-joined',{roomId:roomId,userName:currentUser});socket.on('user-joined',function(users){var peers=[];users.forEach(function(_ref){var userId=_ref.userId,info=_ref.info;var userName=info.userName,video=info.video,audio=info.audio;if(userName!==currentUser){var peer=createPeer(userId,socket.id,stream);peer.userName=userName;peer.peerID=userId;peersRef.current.push({peerID:userId,peer:peer,userName:userName});peers.push(peer);setUserVideoAudio(function(preList){return _objectSpread(_objectSpread({},preList),{},_defineProperty({},peer.userName,{video:video,audio:audio}));});}});setPeers(peers);});socket.on('receiving-call',function(_ref2){var signal=_ref2.signal,from=_ref2.from,info=_ref2.info;var userName=info.userName,video=info.video,audio=info.audio;var peerIdx=findPeer(from);if(!peerIdx){var peer=addPeer(signal,from,stream);peer.userName=userName;peersRef.current.push({peerID:from,peer:peer,userName:userName});setPeers(function(users){return[].concat(_toConsumableArray(users),[peer]);});setUserVideoAudio(function(preList){return _objectSpread(_objectSpread({},preList),{},_defineProperty({},peer.userName,{video:video,audio:audio}));});}});socket.on('accept-call',function(_ref3){var signal=_ref3.signal,answerId=_ref3.answerId;var peerIdx=findPeer(answerId);peerIdx.peer.signal(signal);});// when user leaves the meeting\nsocket.on('user-left',function(_ref4){var userId=_ref4.userId,userName=_ref4.userName;var peerIdx=findPeer(userId);peerIdx.peer.destroy();setPeers(function(users){users=users.filter(function(user){return user.peerID!==peerIdx.peer.peerID;});return _toConsumableArray(users);});});});// toggling video-audio on-off\nsocket.on('toggled-camera',function(_ref5){var userId=_ref5.userId,switchTarget=_ref5.switchTarget;var peerIdx=findPeer(userId);setUserVideoAudio(function(preList){var video=preList[peerIdx.userName].video;var audio=preList[peerIdx.userName].audio;if(switchTarget==='video')video=!video;else audio=!audio;return _objectSpread(_objectSpread({},preList),{},_defineProperty({},peerIdx.userName,{video:video,audio:audio}));});});return function(){socket.disconnect();};},[]);function createPeer(userId,caller,stream){var peer=new Peer({initiator:true,trickle:false,stream:stream});peer.on('signal',function(signal){socket.emit('call-user',{userToCall:userId,from:caller,signal:signal});});peer.on('disconnect',function(){peer.destroy();});return peer;}function addPeer(incomingSignal,callerId,stream){var peer=new Peer({initiator:false,trickle:false,stream:stream});peer.on('signal',function(signal){socket.emit('call-accepted',{signal:signal,to:callerId});});peer.on('disconnect',function(){peer.destroy();});peer.signal(incomingSignal);return peer;}function findPeer(id){return peersRef.current.find(function(p){return p.peerID===id;});}function createUserVideo(peer,index,arr){return/*#__PURE__*/React.createElement(VideoWindow,{className:\"width-peer\".concat(peers.length>8?'':peers.length),onClick:expandScreen,key:index},writeUserName(peer.userName),/*#__PURE__*/React.createElement(FaIcon,{className:\"fas fa-expand\"}),/*#__PURE__*/React.createElement(VideoCard,{key:index,peer:peer,number:arr.length}));}// displays usernames on users window if their video is turned off\nfunction writeUserName(userName,index){if(userVideoAudio.hasOwnProperty(userName)){if(!userVideoAudio[userName].video){return/*#__PURE__*/React.createElement(UserName,{key:userName},userName);}}}// display chat window when chat button is pressed\nvar openChat=function openChat(e){e.stopPropagation();setDisplayChat(!displayChat);};// return the user back to home page when leave button is pressed\nvar goToBack=function goToBack(e){e.preventDefault();socket.emit('leaving-room',{roomId:roomId,leaver:currentUser});sessionStorage.removeItem('user');window.location.href='/';};var toggleCameraAudio=function toggleCameraAudio(e){var target=e.target.getAttribute('data-switch');setUserVideoAudio(function(preList){var videoSwitch=preList['localUser'].video;var audioSwitch=preList['localUser'].audio;if(target==='video'){var userVideoTrack=userVideoRef.current.srcObject.getVideoTracks()[0];videoSwitch=!videoSwitch;userVideoTrack.enabled=videoSwitch;}else{var userAudioTrack=userVideoRef.current.srcObject.getAudioTracks()[0];audioSwitch=!audioSwitch;if(userAudioTrack){userAudioTrack.enabled=audioSwitch;}else{userStream.current.getAudioTracks()[0].enabled=audioSwitch;}}return _objectSpread(_objectSpread({},preList),{},{localUser:{video:videoSwitch,audio:audioSwitch}});});socket.emit('toggling-camera-audio',{roomId:roomId,switchTarget:target});};// when screen share button is pressed\nvar startScreenSharing=function startScreenSharing(){if(!screenShare){navigator.mediaDevices.getDisplayMedia({cursor:true}).then(function(stream){var screenTrack=stream.getTracks()[0];peersRef.current.forEach(function(_ref6){var peer=_ref6.peer;peer.replaceTrack(peer.streams[0].getTracks().find(function(track){return track.kind==='video';}),screenTrack,userStream.current);});// Listen for click on end\nscreenTrack.onended=function(){peersRef.current.forEach(function(_ref7){var peer=_ref7.peer;peer.replaceTrack(screenTrack,peer.streams[0].getTracks().find(function(track){return track.kind==='video';}),userStream.current);});userVideoRef.current.srcObject=userStream.current;setScreenShare(false);};userVideoRef.current.srcObject=stream;screenTrackRef.current=screenTrack;setScreenShare(true);});}else{screenTrackRef.current.onended();}};// full screen view when user clicks on video window\nvar expandScreen=function expandScreen(e){var elem=e.target;if(elem.requestFullscreen){elem.requestFullscreen();}else if(elem.mozRequestFullScreen){/* Firefox */elem.mozRequestFullScreen();}else if(elem.webkitRequestFullscreen){/* Chrome, Safari & Opera */elem.webkitRequestFullscreen();}else if(elem.msRequestFullscreen){/* IE/Edge */elem.msRequestFullscreen();}};var clickBackground=function clickBackground(){if(!showVideoDevices)return;setShowVideoDevices(false);};return/*#__PURE__*/React.createElement(RoomContainer,{onClick:clickBackground},/*#__PURE__*/React.createElement(VideoAndBarContainer,null,/*#__PURE__*/React.createElement(UpperBar,{MeetTitle:roomId,MemberCount:\"\".concat(peers.length+1)}),/*#__PURE__*/React.createElement(VideoContainer,null,/*#__PURE__*/React.createElement(VideoWindow,{className:\"width-peer\".concat(peers.length>8?'':peers.length)},userVideoAudio['localUser'].video?null:/*#__PURE__*/React.createElement(UserName,null,currentUser),/*#__PURE__*/React.createElement(FaIcon,{className:\"fas fa-expand\"}),/*#__PURE__*/React.createElement(MyVideo,{onClick:expandScreen,ref:userVideoRef,muted:true,autoPlay:true,playInline:true})),peers&&peers.map(function(peer,index,arr){return createUserVideo(peer,index,arr);})),/*#__PURE__*/React.createElement(BottomBar,{startScreenSharing:startScreenSharing,openChat:openChat,goToBack:goToBack,toggleCameraAudio:toggleCameraAudio,userVideoAudio:userVideoAudio['localUser'],screenShare:screenShare,videoDevices:videoDevices,showVideoDevices:showVideoDevices,setShowVideoDevices:setShowVideoDevices})),/*#__PURE__*/React.createElement(Chat,{display:displayChat,roomId:roomId}));};//---------------------------------------------------------------------------------------------------\n// styled components:\nvar FaIcon=styled.i(_templateObject());var RoomContainer=styled.div(_templateObject2());var VideoAndBarContainer=styled.div(_templateObject3());var VideoContainer=styled.div(_templateObject4());var MyVideo=styled.video(_templateObject5());var VideoWindow=styled.div(_templateObject6());var UserName=styled.div(_templateObject7());export default MeetRoom;","map":{"version":3,"sources":["C:/Users/osama/Desktop/New folder/cldc-project/server/client/src/components/MeetRoom/MeetRoom.js"],"names":["React","useState","useEffect","useRef","Peer","styled","socket","UpperBar","VideoCard","BottomBar","Chat","MeetRoom","props","currentUser","sessionStorage","getItem","peers","setPeers","localUser","video","audio","userVideoAudio","setUserVideoAudio","videoDevices","setVideoDevices","displayChat","setDisplayChat","screenShare","setScreenShare","showVideoDevices","setShowVideoDevices","peersRef","userVideoRef","screenTrackRef","userStream","roomId","match","params","navigator","mediaDevices","enumerateDevices","then","devices","filtered","filter","device","kind","window","addEventListener","goToBack","getUserMedia","stream","current","srcObject","emit","userName","on","users","forEach","userId","info","peer","createPeer","id","peerID","push","preList","signal","from","peerIdx","findPeer","addPeer","answerId","destroy","user","switchTarget","disconnect","caller","initiator","trickle","userToCall","incomingSignal","callerId","to","find","p","createUserVideo","index","arr","length","expandScreen","writeUserName","hasOwnProperty","openChat","e","stopPropagation","preventDefault","leaver","removeItem","location","href","toggleCameraAudio","target","getAttribute","videoSwitch","audioSwitch","userVideoTrack","getVideoTracks","enabled","userAudioTrack","getAudioTracks","startScreenSharing","getDisplayMedia","cursor","screenTrack","getTracks","replaceTrack","streams","track","onended","elem","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","clickBackground","map","FaIcon","i","RoomContainer","div","VideoAndBarContainer","VideoContainer","MyVideo","VideoWindow","UserName"],"mappings":"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","sourcesContent":["//imports\nimport React, { useState, useEffect, useRef } from 'react';\nimport Peer from 'simple-peer';\nimport styled from 'styled-components';\nimport socket from '../../socket';\nimport UpperBar from '../UpperBar/UpperBar';\nimport VideoCard from '../Video/VideoCard';\nimport BottomBar from '../BottomBar/BottomBar';\nimport Chat from '../Chat/Chat';\n//--------------------------------------------------------------------------------\n\nconst MeetRoom = (props) => {\n  const currentUser = sessionStorage.getItem('user');\n  const [peers, setPeers] = useState([]);\n  const [userVideoAudio, setUserVideoAudio] = useState({\n    localUser: { video: true, audio: true },\n  });\n  const [videoDevices, setVideoDevices] = useState([]);\n  const [displayChat, setDisplayChat] = useState(false);\n  const [screenShare, setScreenShare] = useState(false);\n  const [showVideoDevices, setShowVideoDevices] = useState(false);\n  const peersRef = useRef([]);\n  const userVideoRef = useRef();\n  const screenTrackRef = useRef();\n  const userStream = useRef();\n  const roomId = props.match.params.roomId;\n\n  useEffect(() => {\n\n    navigator.mediaDevices.enumerateDevices().then((devices) => {\n      const filtered = devices.filter((device) => device.kind === 'videoinput');\n      setVideoDevices(filtered);\n    });\n\n    window.addEventListener('popstate', goToBack);\n\n    navigator.mediaDevices\n      .getUserMedia({ video: true, audio: true })\n      .then((stream) => {\n        userVideoRef.current.srcObject = stream;\n        userStream.current = stream;\n\n        // user joins room\n        socket.emit('room-joined', { roomId, userName: currentUser });\n        socket.on('user-joined', (users) => {\n\n          const peers = [];\n          users.forEach(({ userId, info }) => {\n            let { userName, video, audio } = info;\n\n            if (userName !== currentUser) {\n              const peer = createPeer(userId, socket.id, stream);\n\n              peer.userName = userName;\n              peer.peerID = userId;\n\n              peersRef.current.push({\n                peerID: userId,\n                peer,\n                userName,\n              });\n              peers.push(peer);\n\n              setUserVideoAudio((preList) => {\n                return {\n                  ...preList,\n                  [peer.userName]: { video, audio },\n                };\n              });\n            }\n          });\n\n          setPeers(peers);\n        });\n\n\n        socket.on('receiving-call', ({ signal, from, info }) => {\n          let { userName, video, audio } = info;\n          const peerIdx = findPeer(from);\n\n          if (!peerIdx) {\n            const peer = addPeer(signal, from, stream);\n\n            peer.userName = userName;\n\n            peersRef.current.push({\n              peerID: from,\n              peer,\n              userName: userName,\n            });\n            setPeers((users) => {\n              return [...users, peer];\n            });\n            setUserVideoAudio((preList) => {\n              return {\n                ...preList,\n                [peer.userName]: { video, audio },\n              };\n            });\n          }\n        });\n\n\n        socket.on('accept-call', ({ signal, answerId }) => {\n          const peerIdx = findPeer(answerId);\n          peerIdx.peer.signal(signal);\n        });\n\n\n        // when user leaves the meeting\n        socket.on('user-left', ({ userId, userName }) => {\n          const peerIdx = findPeer(userId);\n          peerIdx.peer.destroy();\n          setPeers((users) => {\n            users = users.filter((user) => user.peerID !== peerIdx.peer.peerID);\n            return [...users];\n          });\n        });\n      });\n\n\n      // toggling video-audio on-off\n    socket.on('toggled-camera', ({ userId, switchTarget }) => {\n      const peerIdx = findPeer(userId);\n\n      setUserVideoAudio((preList) => {\n        let video = preList[peerIdx.userName].video;\n        let audio = preList[peerIdx.userName].audio;\n\n        if (switchTarget === 'video') video = !video;\n        else audio = !audio;\n\n        return {\n          ...preList,\n          [peerIdx.userName]: { video, audio },\n        };\n      });\n    });\n\n\n    return () => {\n      socket.disconnect();\n    };\n\n  }, []);\n\n\n  function createPeer(userId, caller, stream) {\n    const peer = new Peer({\n      initiator: true,\n      trickle: false,\n      stream,\n    });\n\n    peer.on('signal', (signal) => {\n      socket.emit('call-user', {\n        userToCall: userId,\n        from: caller,\n        signal,\n      });\n    });\n    peer.on('disconnect', () => {\n      peer.destroy();\n    });\n\n    return peer;\n  }\n\n\n  function addPeer(incomingSignal, callerId, stream) {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream,\n    });\n\n    peer.on('signal', (signal) => {\n      socket.emit('call-accepted', { signal, to: callerId });\n    });\n\n    peer.on('disconnect', () => {\n      peer.destroy();\n    });\n\n    peer.signal(incomingSignal);\n\n    return peer;\n  }\n\n\n  function findPeer(id) {\n    return peersRef.current.find((p) => p.peerID === id);\n  }\n\n\n  function createUserVideo(peer, index, arr) {\n    return (\n      <VideoWindow\n        className={`width-peer${peers.length > 8 ? '' : peers.length}`}\n        onClick={expandScreen}\n        key={index}\n      >\n        {writeUserName(peer.userName)}\n        <FaIcon className='fas fa-expand' />\n        <VideoCard key={index} peer={peer} number={arr.length} />\n      </VideoWindow>\n    );\n  }\n\n\n  // displays usernames on users window if their video is turned off\n  function writeUserName(userName, index) {\n    if (userVideoAudio.hasOwnProperty(userName)) {\n      if (!userVideoAudio[userName].video) {\n        return <UserName key={userName}>{userName}</UserName>;\n      }\n    }\n  }\n\n\n  // display chat window when chat button is pressed\n  const openChat = (e) => {\n    e.stopPropagation();\n    setDisplayChat(!displayChat);\n  };\n\n\n  // return the user back to home page when leave button is pressed\n  const goToBack = (e) => {\n    e.preventDefault();\n    socket.emit('leaving-room', { roomId, leaver: currentUser });\n    sessionStorage.removeItem('user');\n    window.location.href = '/';\n  };\n\n\n  const toggleCameraAudio = (e) => {\n    const target = e.target.getAttribute('data-switch');\n\n    setUserVideoAudio((preList) => {\n      let videoSwitch = preList['localUser'].video;\n      let audioSwitch = preList['localUser'].audio;\n\n      if (target === 'video') {\n        const userVideoTrack = userVideoRef.current.srcObject.getVideoTracks()[0];\n        videoSwitch = !videoSwitch;\n        userVideoTrack.enabled = videoSwitch;\n      } else {\n        const userAudioTrack = userVideoRef.current.srcObject.getAudioTracks()[0];\n        audioSwitch = !audioSwitch;\n\n        if (userAudioTrack) {\n          userAudioTrack.enabled = audioSwitch;\n        } else {\n          userStream.current.getAudioTracks()[0].enabled = audioSwitch;\n        }\n      }\n\n      return {\n        ...preList,\n        localUser: { video: videoSwitch, audio: audioSwitch },\n      };\n    });\n\n    socket.emit('toggling-camera-audio', { roomId, switchTarget: target });\n  };\n\n  // when screen share button is pressed\n  const startScreenSharing = () => {\n    if (!screenShare) {\n      navigator.mediaDevices\n        .getDisplayMedia({ cursor: true })\n        .then((stream) => {\n          const screenTrack = stream.getTracks()[0];\n\n          peersRef.current.forEach(({ peer }) => {\n            \n            peer.replaceTrack(\n              peer.streams[0]\n                .getTracks()\n                .find((track) => track.kind === 'video'),\n              screenTrack,\n              userStream.current\n            );\n          });\n\n          // Listen for click on end\n          screenTrack.onended = () => {\n            peersRef.current.forEach(({ peer }) => {\n              peer.replaceTrack(\n                screenTrack,\n                peer.streams[0]\n                  .getTracks()\n                  .find((track) => track.kind === 'video'),\n                userStream.current\n              );\n            });\n            userVideoRef.current.srcObject = userStream.current;\n            setScreenShare(false);\n          };\n\n          userVideoRef.current.srcObject = stream;\n          screenTrackRef.current = screenTrack;\n          setScreenShare(true);\n        });\n    } else {\n      screenTrackRef.current.onended();\n    }\n  };\n\n  // full screen view when user clicks on video window\n  const expandScreen = (e) => {\n    const elem = e.target;\n\n    if (elem.requestFullscreen) {\n      elem.requestFullscreen();\n    } else if (elem.mozRequestFullScreen) {\n      /* Firefox */\n      elem.mozRequestFullScreen();\n    } else if (elem.webkitRequestFullscreen) {\n      /* Chrome, Safari & Opera */\n      elem.webkitRequestFullscreen();\n    } else if (elem.msRequestFullscreen) {\n      /* IE/Edge */\n      elem.msRequestFullscreen();\n    }\n  };\n\n  const clickBackground = () => {\n    if (!showVideoDevices) return;\n\n    setShowVideoDevices(false);\n  }\n\n  return (\n    <RoomContainer onClick={clickBackground}>\n\n      <VideoAndBarContainer>\n\n        <UpperBar MeetTitle={roomId} MemberCount={`${peers.length + 1}`} />\n\n        <VideoContainer>\n\n          <VideoWindow\n            className={`width-peer${peers.length > 8 ? '' : peers.length}`}\n          >\n            {userVideoAudio['localUser'].video ? null : (\n              <UserName>{currentUser}</UserName>\n            )}\n            <FaIcon className='fas fa-expand' />\n            <MyVideo\n              onClick={expandScreen}\n              ref={userVideoRef}\n              muted\n              autoPlay\n              playInline\n            ></MyVideo>\n          </VideoWindow>\n\n          {peers &&\n            peers.map((peer, index, arr) => createUserVideo(peer, index, arr))}\n        </VideoContainer>\n\n        <BottomBar\n          startScreenSharing={startScreenSharing}\n          openChat={openChat}\n          goToBack={goToBack}\n          toggleCameraAudio={toggleCameraAudio}\n          userVideoAudio={userVideoAudio['localUser']}\n          screenShare={screenShare}\n          videoDevices={videoDevices}\n          showVideoDevices={showVideoDevices}\n          setShowVideoDevices={setShowVideoDevices}\n        />\n\n      </VideoAndBarContainer>\n\n      <Chat display={displayChat} roomId={roomId} />\n\n    </RoomContainer>\n  );\n};\n\n//---------------------------------------------------------------------------------------------------\n// styled components:\n\nconst FaIcon = styled.i`\n  display: none;\n  position: absolute;\n  right: 15px;\n  top: 15px;\n`;\n\nconst RoomContainer = styled.div`\n  display: flex;\n  width: 100%;\n  max-height: 100vh;\n  flex-direction: row;\n  background-color: #f0f0f0;\n`;\n\nconst VideoAndBarContainer = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100vh;\n`;\n\nconst VideoContainer = styled.div`\n  max-width: 100%;\n  height: 86%;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-around;\n  flex-wrap: wrap;\n  align-items: center;\n  padding: 15px;\n  box-sizing: border-box;\n  gap: 10px;\n`;\n\nconst MyVideo = styled.video``;\n\nconst VideoWindow = styled.div`\n  justify-content: center;\n  align-items: center;  \n  position: relative;\n  display: flex;\n  \n  > video {\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n\n  :hover {\n    > i {\n      display: block;\n    }\n  }\n`;\n\nconst UserName = styled.div`\n  position: absolute;\n  font-size: calc(20px + 5vmin);\n  z-index: 1;\n`;\n\nexport default MeetRoom;\n"]},"metadata":{},"sourceType":"module"}